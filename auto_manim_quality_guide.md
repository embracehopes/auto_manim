# auto_manim åŠ¨ç”»è´¨é‡æå‡æŒ‡å— v2.0

> é¢å‘ ManimGL + AutoScene çš„**é«˜è´¨é‡åŠ¨ç”»åˆ¶ä½œ**å…¨æ–¹ä½æŒ‡å—ï¼Œæ¶µç›–å·¥ä½œæµä¼˜åŒ–ã€è§†è§‰è®¾è®¡ã€åŠ¨æ€ç­–ç•¥ã€æ—¶é—´è½´æ§åˆ¶ã€æ€§èƒ½è°ƒä¼˜ç­‰å„ä¸ªç»´åº¦ã€‚

---

## ğŸ“‹ ç›®å½•

- [0. è´¨é‡ç›®æ ‡ä¸è¾“å‡ºæ ‡å‡†](#0-è´¨é‡ç›®æ ‡ä¸è¾“å‡ºæ ‡å‡†)
- [1. å·¥ä½œæµåˆ†å±‚ä¸è´¨é‡é—¨æ§›](#1-å·¥ä½œæµåˆ†å±‚ä¸è´¨é‡é—¨æ§›)
- [2. è¾“å…¥ç´ æå¤„ç†ä¼˜åŒ–](#2-è¾“å…¥ç´ æå¤„ç†ä¼˜åŒ–)
- [3. æ–‡æ¡ˆä¸æ—¶é—´è½´ä¼˜åŒ–](#3-æ–‡æ¡ˆä¸æ—¶é—´è½´ä¼˜åŒ–)
- [4. ç”»é¢æ’ç‰ˆä¸è§†è§‰å±‚çº§](#4-ç”»é¢æ’ç‰ˆä¸è§†è§‰å±‚çº§)
- [5. åŠ¨ç”»è¡”æ¥ä¸èŠ‚å¥æ§åˆ¶](#5-åŠ¨ç”»è¡”æ¥ä¸èŠ‚å¥æ§åˆ¶)
- [6. å¯è§†åŒ–åŒºåŠ¨æ€ç­–ç•¥](#6-å¯è§†åŒ–åŒºåŠ¨æ€ç­–ç•¥)
- [7. å­—å¹•ä¸é…éŸ³ç³»ç»Ÿ](#7-å­—å¹•ä¸é…éŸ³ç³»ç»Ÿ)
- [8. ç›¸æœºä¸æ„å›¾æ§åˆ¶](#8-ç›¸æœºä¸æ„å›¾æ§åˆ¶)
- [9. éŸ³æ•ˆä¸é…ä¹ç­–ç•¥](#9-éŸ³æ•ˆä¸é…ä¹ç­–ç•¥)
- [10. è§†è§‰å¼•å¯¼ä¸æ ‡æ³¨ç³»ç»Ÿ](#10-è§†è§‰å¼•å¯¼ä¸æ ‡æ³¨ç³»ç»Ÿ)
- [11. è¾‰å…‰ä¸ç‰¹æ•ˆä½¿ç”¨](#11-è¾‰å…‰ä¸ç‰¹æ•ˆä½¿ç”¨)
- [12. é¢œè‰²ä¸é…è‰²ç­–ç•¥](#12-é¢œè‰²ä¸é…è‰²ç­–ç•¥)
- [13. ä»£ç ç»„ç»‡ä¸å¯ç»´æŠ¤æ€§](#13-ä»£ç ç»„ç»‡ä¸å¯ç»´æŠ¤æ€§)
- [14. æ€§èƒ½ä¸æ¸²æŸ“ç¨³å®šæ€§](#14-æ€§èƒ½ä¸æ¸²æŸ“ç¨³å®šæ€§)
- [15. è‡ªåŠ¨åŒ–å·¥å…·ä¸æ£€æŸ¥å™¨](#15-è‡ªåŠ¨åŒ–å·¥å…·ä¸æ£€æŸ¥å™¨)
- [16. äº¤ä»˜å‰æ£€æŸ¥æ¸…å•](#16-äº¤ä»˜å‰æ£€æŸ¥æ¸…å•)
- [17. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#17-å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
- [18. åç»­å¯è½åœ°ä¼˜åŒ–é¡¹](#18-åç»­å¯è½åœ°ä¼˜åŒ–é¡¹)

---

## 0. è´¨é‡ç›®æ ‡ä¸è¾“å‡ºæ ‡å‡†

### 0.1 æ ¸å¿ƒè´¨é‡æŒ‡æ ‡

| ç»´åº¦ | ç›®æ ‡ | é‡åŒ–æ ‡å‡† |
|------|------|----------|
| **ä¿¡æ¯æ¸…æ™°åº¦** | é¢˜é¢ã€æ¡ä»¶ã€æ¨å¯¼ä¸ç»“è®ºä¸€çœ¼å¯è¯» | å•å±ä¿¡æ¯å¯†åº¦ â‰¤ 6 ä¸ªè§†è§‰å…ƒç´  |
| **è§†è§‰å±‚çº§** | æ ‡é¢˜ > é¢˜ç›® > å¯è§†åŒ– > æ¨å¯¼ > å­—å¹• | å­—å·é€’å‡æ¯”ä¾‹ 1.2:1 |
| **æ—¶åºå¯¹é½** | éŸ³ç”»å®Œç¾åŒæ­¥ | è¯¯å·® â‰¤ 0.2s |
| **åŠ¨æ€è¿ç»­æ€§** | è®²è§£æ®µæ— é™æ­¢ç”»é¢ | æ¯ 3s è‡³å°‘ 1 ä¸ªè§†è§‰å˜åŒ– |
| **ç”»é¢æ•´æ´åº¦** | ç»Ÿä¸€é…è‰²ã€é¿å…æ‚ä¹± | åŒå±é¢œè‰² â‰¤ 4 ç§ |

### 0.2 è§‚ä¼—ä½“éªŒç›®æ ‡

- **å¼€åœº 3 ç§’æ³•åˆ™**ï¼šé…éŸ³ + åŠ¨ç”» + éŸ³æ•ˆåŒæ—¶å‡ºç°ï¼ŒæŠ“ä½æ³¨æ„åŠ›
- **ä¿¡æ¯å¯†åº¦é€‚ä¸­**ï¼šé¿å…"ä¿¡æ¯è½°ç‚¸"ï¼Œä¹Ÿé¿å…"æ— æ„ä¹‰ç•™ç™½"
- **è§†è§‰å¼•å¯¼æ¸…æ™°**ï¼šè§‚ä¼—çŸ¥é“è¯¥çœ‹å“ªé‡Œ
- **èŠ‚å¥æ„Ÿæ˜ç¡®**ï¼šé‡ç‚¹æ…¢ã€é“ºå«å¿«ã€è½¬åœºè½»

### 0.3 æŠ€æœ¯è´¨é‡æ ‡å‡†

```
âœ… å¿…é¡»è¾¾æˆï¼š
  - ä»£ç å¯ä¸€æ¬¡è¿è¡ŒæˆåŠŸ
  - æ—  LaTeX ç¼–è¯‘é”™è¯¯
  - æ— å¸ƒå±€è¶Šç•Œ/é‡å 
  - æ—¶é—´è½´æ— è´Ÿæ—¶é•¿/é‡å 

â­ æ¨èè¾¾æˆï¼š
  - å¯è§†åŒ–åŒºå­˜åœ¨ Updater åŠ¨æ€
  - å…³é”®ç»“è®ºæœ‰é«˜äº®/Focus
  - Transform è¡”æ¥ â‰¥ 50%
  - é…éŸ³è‡ªç„¶æµç•…
```

---

## 1. å·¥ä½œæµåˆ†å±‚ä¸è´¨é‡é—¨æ§›

### 1.1 ä¸‰å±‚å·¥ä½œæµæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Layer 1: è¾“å…¥å±‚                       â”‚
â”‚    é¢˜ç›®å›¾ç‰‡ / è§†é¢‘è§£æ / PPTå¤åˆ» â†’ ç»“æ„åŒ–ä¿¡æ¯æå–          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Layer 2: ç¼–æ’å±‚                       â”‚
â”‚    AI-1 ç”Ÿæˆ JSON æ—¶é—´è½´ â†’ äººå·¥æ ¡å¯¹ â†’ ç¡®å®šç»“æ„åŒ–è„šæœ¬        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Layer 3: æ¸²æŸ“å±‚                       â”‚
â”‚    AI-2 ç”Ÿæˆ ManimGL ä»£ç  â†’ è°ƒè¯•ä¼˜åŒ– â†’ æ¸²æŸ“è¾“å‡º            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 è¾“å…¥å±‚è´¨é‡é—¨æ§›

| è¾“å…¥ç±»å‹ | é¢„å¤„ç†è¦æ±‚ | è´¨é‡æ£€æŸ¥ç‚¹ |
|----------|------------|------------|
| **å›¾ç‰‡é¢˜** | è£åˆ‡/çº å/å»å™ª/é«˜åˆ†è¾¨ç‡ | OCR ç½®ä¿¡åº¦ â‰¥ 80%ï¼Œä½ç½®ä¿¡åº¦å¿…é¡»æ ‡æ³¨ |
| **è§†é¢‘è§£æ** | æ‹†é•œå¤´/æå–å…³é”®å¸§/è½¬å½•å­—å¹• | æ—¶é—´æˆ³ç²¾åº¦ â‰¤ 0.5s |
| **PPTå¤åˆ»** | é€é¡µå¯¼å‡º/æå–åŠ¨ç”»é¡ºåº | æ–‡æœ¬/å…¬å¼å®Œæ•´æ— é—æ¼ |

### 1.3 JSON æ—¶é—´è½´è´¨é‡é—¨æ§›

```json
{
  "meta": {
    "title": "è§†é¢‘æ ‡é¢˜",
    "resolution": "1080x1920",
    "target_duration": [60, 120]
  },
  "timeline": [...]
}
```

**å¿…é¡»æ»¡è¶³**ï¼š
- âœ… `start/end` å•è°ƒé€’å¢ã€æ— é‡å 
- âœ… æ¯å¥éƒ½æœ‰ `visual_action`ï¼Œä¸”å¯é©±åŠ¨ç”»é¢
- âœ… å¥é•¿ < 26 å­—ï¼Œè¶…é•¿å¿…é¡»æ‹†å¥
- âœ… `narration` å£è¯­åŒ–ï¼ˆTTS å‹å¥½ï¼‰ï¼Œ`screen_text/latex` æ•°å­¦åŒ–
- âœ… æ€»æ—¶é•¿ç¬¦åˆ `target_duration` èŒƒå›´

### 1.4 ä»£ç å±‚è´¨é‡é—¨æ§›

```python
# ä»£ç å¿…é¡»åŒ…å«ï¼š
class MyScene(AutoScene):
    # âœ… 1. å¸¸é‡é…ç½®åŒºï¼ˆä½ç½®/å¤§å°/é¢œè‰²å¯è°ƒï¼‰
    TITLE_Y = 5.5
    VIZ_Y = 0.8
    
    # âœ… 2. æ—¶é—´è½´é©±åŠ¨å™¨ä¸‰ä»¶å¥—
    def play_t(self, *anims, rt=1): ...
    def wait_t(self, dt): ...
    def wait_until(self, target): ...
    
    # âœ… 3. é˜¶æ®µåŒ–ç»„ç»‡
    def phase1_title(self): ...
    def phase2_problem(self): ...
    
    # âœ… 4. åŠ¨æ€ Updaterï¼ˆè‡³å°‘ 1 ä¸ªï¼‰
    # âœ… 5. Transform è¡”æ¥ï¼ˆç›¸ä¼¼ç‰©ä½“ï¼‰
    # âœ… 6. Indicate/é«˜äº®åŠ¨ä½œï¼ˆå…³é”®ç»“è®ºï¼‰
```

---

## 2. è¾“å…¥ç´ æå¤„ç†ä¼˜åŒ–

### 2.1 å›¾ç‰‡é¢˜å¤„ç†æµç¨‹

```
åŸå›¾ â†’ OCR + ç‰ˆé¢ç†è§£ â†’ å¯é æ€§æ ‡æ³¨ â†’ é‡æ’ç‰ˆé¢˜é¢ â†’ Transform è¿‡æ¸¡
```

**OCR ç½®ä¿¡åº¦å¤„ç†ç­–ç•¥**ï¼š

| ç½®ä¿¡åº¦ | å¤„ç†æ–¹å¼ |
|--------|----------|
| é«˜ (â‰¥90%) | ç›´æ¥ä½¿ç”¨ |
| ä¸­ (70-90%) | äººå·¥å¤æ ¸åä½¿ç”¨ |
| ä½ (<70%) | å¿…é¡»æ ‡æ³¨ `ã€?ã€‘`ï¼Œæä¾› A/B ä¸¤å¥—æ–¹æ¡ˆ |

**é¢˜é¢é‡æ’ç‰ˆåŸåˆ™**ï¼š
- æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚"ä¾‹é¢˜ï¼šxxx"
- é¢˜å¹²ï¼šæŒ‰è¯­ä¹‰æ–­è¡Œï¼Œé¿å…ä¸€è¡Œè¿‡é•¿
- å…¬å¼ï¼šå…¨éƒ¨ç»™å‡ºå¯ç¼–è¯‘ LaTeX
- å°é—®ï¼šç¼–å·ç»Ÿä¸€ (1)(2)(3)

### 2.2 è§†é¢‘/PPT è§£æè¦ç‚¹

**åˆ†é•œè„šæœ¬å¿…é¡»åŒ…å«**ï¼š
- Shot ç¼–å· + æ—¶é—´èŒƒå›´
- ç”»é¢çŠ¶æ€æè¿°ï¼ˆå“ªäº›å¯¹è±¡åœ¨ç”»é¢ä¸Šï¼‰
- æ ¸å¿ƒå˜åŒ–ï¼ˆå‡ºç°/æ¶ˆå¤±/ç§»åŠ¨/å˜å½¢/é«˜äº®/ç›¸æœºè¿åŠ¨ï¼‰
- è®²è§£æ„å›¾ï¼ˆè¿™ä¸€é•œå¤´è®²ä»€ä¹ˆï¼‰

**å¯¹è±¡å¤ç”¨å…³ç³»**ï¼š
- æ˜ç¡®æ ‡æ³¨å“ªäº›å¯¹è±¡è·¨é•œå¤´å¤ç”¨
- å¤ç”¨å¯¹è±¡ç”¨ Transform è¡”æ¥ï¼Œè€Œé FadeOut + FadeIn

### 2.3 å¤šé¢˜ç›®å¤„ç†

- å…ˆæ‹†åˆ†é¢˜å·ï¼Œæ¯é¢˜ç‹¬ç«‹å¤„ç†
- æä¾›"æ€»ç›®å½•é•œå¤´"å¯é€‰
- é¢˜ç›®åˆ‡æ¢æ—¶ä½¿ç”¨è½¬åœºåŠ¨ç”»

---

## 3. æ–‡æ¡ˆä¸æ—¶é—´è½´ä¼˜åŒ–

### 3.1 ä¸€å¥ä¸€åŠ¨ä½œåŸåˆ™

```
âŒ é”™è¯¯ï¼šä¸€å¥è¯åŒ…å«å¤šä¸ªåŠ¨ä½œ
   "é¦–å…ˆè®¾ x = aï¼Œä»£å…¥æ–¹ç¨‹ï¼ŒåŒ–ç®€å¾—åˆ° xÂ² = 4"

âœ… æ­£ç¡®ï¼šæ‹†åˆ†ä¸ºå¤šå¥
   "é¦–å…ˆï¼Œæˆ‘ä»¬è®¾ x = a"          â†’ visual_action: å†™å…¥è®¾å˜é‡
   "ä»£å…¥åŸæ–¹ç¨‹"                  â†’ visual_action: é«˜äº®æ–¹ç¨‹
   "åŒ–ç®€åå¾—åˆ° xÂ² = 4"           â†’ visual_action: Transform æ¨å¯¼
```

### 3.2 è¯­é€Ÿä¸åœé¡¿æ ‡å‡†

| æ®µè½ç±»å‹ | è¯­é€Ÿï¼ˆå­—/ç§’ï¼‰ | è¯´æ˜ |
|----------|--------------|------|
| intro | 5 | å¼€åœºèŠ‚å¥ç¨å¿«ï¼ŒæŠ“æ³¨æ„åŠ› |
| middle | 4.5 | æ­£æ–‡è®²è§£é€‚ä¸­ |
| outro | 5 | æ€»ç»“æ”¶å°¾å¹²å‡€åˆ©è½ |

**åœé¡¿è§„åˆ™**ï¼š
- å¥æœ«åœé¡¿ï¼š0.2â€“0.4sï¼ˆè‡ªç„¶æ°”å£ï¼‰
- è½¬åœºåœé¡¿ï¼š0.6â€“1.0sï¼ˆå•ç‹¬äº‹ä»¶ï¼Œ`visual_action="è½¬åœº"`ï¼‰
- TTS æ°”å£ï¼š0.5sï¼ˆAutoScene é»˜è®¤ `VOICE_GAP_DURATION`ï¼‰

### 3.3 é…éŸ³ä¸å­—å¹•åˆ†ç¦»

```python
# é…éŸ³å£è¯­åŒ–ï¼Œå­—å¹•æ•°å­¦åŒ–
self.speak(
    text="ç”± f 2 ç­‰äº 4",           # TTS æœ—è¯»ï¼ˆå£è¯­ï¼‰
    subtitle="ç”± f(2) = 4",          # å±å¹•æ˜¾ç¤ºï¼ˆç¬¦å·ï¼‰
    color_map={"4": YELLOW}
)
```

**è½¬æ¢è§„åˆ™é€ŸæŸ¥**ï¼š

| ç±»å‹ | é…éŸ³ (text) | å­—å¹• (subtitle) |
|------|-------------|-----------------|
| è´Ÿå· | `f è´Ÿ 2 ç­‰äº è´Ÿ 4` | `f(-2) = -4` |
| ç­‰å· | `a ç­‰äº 5` | `a = 5` |
| åæ ‡ | `åæ ‡ 2 4` | `(2, 4)` |
| å°äº | `x å°äº 0` | `x < 0` |
| å¹³æ–¹ | `x å¹³æ–¹` | `xÂ²` |
| åˆ†æ•° | `ä¸‰åˆ†ä¹‹äºŒ` | `2/3` |

### 3.4 å…³é”®è¯ä¸Šè‰²ç­–ç•¥

```python
# âœ… æ­£ç¡®ï¼šå•ä¸€å¼ºè°ƒè‰²ï¼Œå…³é”®è¯å°‘è€Œç²¾
self.speak("é‡ç‚¹æ˜¯å¥‡å‡½æ•°æ€§è´¨", color_map={"å¥‡å‡½æ•°æ€§è´¨": YELLOW})

# âŒ é”™è¯¯ï¼šå¤šè‰²æ³›æ»¥
self.speak("é‡ç‚¹æ˜¯å¥‡å‡½æ•°æ€§è´¨", color_map={"é‡ç‚¹": RED, "å¥‡å‡½æ•°": BLUE, "æ€§è´¨": GREEN})
```

---

## 4. ç”»é¢æ’ç‰ˆä¸è§†è§‰å±‚çº§

### 4.1 å…­å—å¸ƒå±€å›ºå®šé¡ºåº

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â† é¡¶éƒ¨ y â‰ˆ 5.5
â”‚           Title (æ ‡é¢˜)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Divider (åˆ†å‰²çº¿)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Problem (é¢˜ç›®)         â”‚  â† y â‰ˆ 3.5
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Viz (å¯è§†åŒ–åŒºåŸŸ)          â”‚  â† y â‰ˆ 0.8
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        Derivation (æ¨å¯¼åŒº)       â”‚  â† y â‰ˆ -2.2
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Subtitle (å­—å¹•)          â”‚  â† åº•éƒ¨ y â‰ˆ -5.2
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å­—å·å±‚çº§é…ç½®

| æ¨¡å— | å»ºè®®å­—å· | ç¼©æ”¾å‚è€ƒ |
|------|----------|----------|
| Title | 40â€“48 | 1.0x |
| Problem | 28â€“34 | 0.75x |
| Derivation | 26â€“32 | 0.7x |
| Subtitle | 22â€“28 | 0.6x |
| å¯è§†åŒ–æ ‡ç­¾ | 14â€“20 | 0.45x |

### 4.3 æ¨ªå‘æ’ç‰ˆçº¦æŸ

```python
# ç«–ç‰ˆè§†é¢‘å‚æ•°
SCREEN_WIDTH = 27/4  # 6.75 Manim å•ä½
MARGIN_RATIO = 0.05  # å·¦å³è¾¹è·æ¯”ä¾‹

# å®‰å…¨å®½åº¦
m = min(0.2, MARGIN_RATIO * SCREEN_WIDTH)
W = SCREEN_WIDTH - 2 * m

# ç›®æ ‡å¡«å……æ¯”ä¾‹
target_max = 0.95 * W   # è¶…è¿‡å¿…é¡»æ¢è¡Œ
target_fill = 0.92 * W  # å°½é‡å¡«æ»¡
target_min = 0.85 * W   # ä½äºåˆ™æ”¾å¤§
```

**é¿å…"ç»†é•¿æ¡"ç­–ç•¥**ï¼š
1. å…ˆæ¢è¡Œæ§åˆ¶ max_width
2. æ¢è¡Œåè‹¥å®½åº¦ < target_minï¼Œåˆ™ scale_to_fit_width(target_fill)

### 4.4 çºµå‘é—´è·è‡ªé€‚åº”

```python
def layout_vertical(blocks, frame_h, buff_min=0.18, buff_max=0.45):
    """
    è‡ªé€‚åº”å‚ç›´å¸ƒå±€
    
    ç­–ç•¥ï¼š
    1. è®¡ç®—å¯ç”¨é—´è· gap_budget
    2. å‡åŒ€åˆ†é… buff
    3. è¶…å‡ºæ—¶æŒ‰ä¼˜å…ˆçº§ç¼©æ”¾ï¼šSubtitle â†’ Derivation â†’ Problem
    4. Viz ä¿ç•™æœ€å°é«˜åº¦ â‰¥ 0.28 * frame_h
    """
```

### 4.5 æ¨å¯¼åŒºä¸å­—å¹•é˜²é‡å 

```python
# ä½¿ç”¨ AutoScene å†…ç½®æ–¹æ³•
self.ensure_above_subtitle(
    derivation_group,
    viz_bottom_y=viz.get_bottom()[1],
    margin=0.3,
    overlap_buff=0.2
)
```

**é€»è¾‘**ï¼š
- é‡å æ—¶ï¼šå‘ä¸Šç§»åŠ¨ + é¢å¤– `overlap_buff`
- æ— é‡å æ—¶ï¼šå±…ä¸­æ”¾ç½®äºå¯è§†åŒ–åº•éƒ¨å’Œå­—å¹•é¡¶éƒ¨ä¹‹é—´

---

## 5. åŠ¨ç”»è¡”æ¥ä¸èŠ‚å¥æ§åˆ¶

### 5.1 Transform ä¼˜å…ˆåŸåˆ™

```python
# âœ… æ¨èï¼šç›¸ä¼¼ç‰©ä½“ç”¨ Transform
old_eq = Tex(r"x^2 + 2x")
new_eq = Tex(r"x^2 + 2x + 1")
self.play(TransformMatchingTex(old_eq, new_eq))

# âŒ é¿å…ï¼šæ— æ„ä¹‰ FadeOut + FadeIn
self.play(FadeOut(old_eq))
self.play(FadeIn(new_eq))
```

**Transform ç±»å‹é€‰æ‹©**ï¼š

| åœºæ™¯ | æ¨èåŠ¨ç”» |
|------|----------|
| å…¬å¼å¾®è°ƒ | `TransformMatchingTex` |
| ç›¸ä¼¼å½¢çŠ¶ | `TransformMatchingShapes` |
| æ–‡æœ¬å˜åŒ– | `TransformMatchingStrings` |
| å®Œå…¨ä¸åŒ | `ReplacementTransform` / `FadeTransform` |
| é¦–æ¬¡å‡ºç° | `Write` / `FadeIn` |

### 5.2 æ¸è¿›å±•ç¤ºç­–ç•¥

```python
# åŒå±ä¿¡æ¯å¯†åº¦æ§åˆ¶ï¼šè¶…è¿‡ 6 ä¸ªå…ƒç´ æ—¶åˆ†æ‰¹æ˜¾ç¤º
if len(new_elements) > 6:
    # åˆ†æ‰¹ FadeOut æ—§å†…å®¹ï¼ŒFadeIn æ–°å†…å®¹
    self.play(FadeOut(batch_1))
    self.play(FadeIn(batch_2))
```

### 5.3 å˜é€ŸèŠ‚å¥è®¾è®¡

| å†…å®¹ç±»å‹ | run_time | rate_func |
|----------|----------|-----------|
| é‡ç‚¹å…¬å¼ | 2.0â€“3.0s | smooth |
| é“ºå«è¿‡æ¸¡ | 0.5â€“1.0s | smooth |
| è½¬åœºæ¸…ç©º | 0.3â€“0.5s | smooth |
| é«˜äº®é—ªçƒ | 0.5â€“0.8s | there_and_back |

### 5.4 åŠ¨ç”»é»˜è®¤å‚æ•°

```python
# æ‰€æœ‰ self.play() æ˜¾å¼æŒ‡å®šå‚æ•°
self.play(Write(formula), rate_func=smooth, run_time=2)

# ç¦æ­¢éšå¼ä¾èµ–é»˜è®¤å€¼
```

---

## 6. å¯è§†åŒ–åŒºåŠ¨æ€ç­–ç•¥

### 6.1 å¼ºåˆ¶ Updater è¦æ±‚

**æ¯ä¸ªå¯è§†åŒ–åŒºåŸŸè‡³å°‘åŒ…å« 1 ä¸ªæŒç»­æ›´æ–°çš„å¯¹è±¡**ï¼Œå…¨ç¨‹ä¸èƒ½æ˜¯"ç”»é¢é™æ­¢ã€åªæœ‰å­—å¹•åœ¨å˜"ã€‚

### 6.2 åŠ¨æ€å±•ç¤ºæ¨¡å¼ï¼ˆä»»é€‰å…¶ä¸€ï¼‰

```python
# æ¨¡å¼ 1ï¼šValueTracker + DecimalNumber
b_tracker = ValueTracker(0)
decimal = DecimalNumber(0, num_decimal_places=2)
decimal.add_updater(lambda d: d.set_value(b_tracker.get_value()))
self.play(b_tracker.animate.set_value(4), run_time=3)

# æ¨¡å¼ 2ï¼šæ›²çº¿/ç‚¹éšå‚æ•°å˜åŒ–
def get_dynamic_curve():
    b = b_tracker.get_value()
    return axes.get_graph(lambda x: x**2 + b*x, x_range=[-5, 5])
curve = always_redraw(get_dynamic_curve)

# æ¨¡å¼ 3ï¼šæ¸¸æ ‡æ²¿è·¯å¾„ç§»åŠ¨
cursor = Dot(color=YELLOW)
cursor.add_updater(lambda c: c.move_to(path.point_from_proportion(t.get_value())))

# æ¨¡å¼ 4ï¼šå‘¼å¸é«˜äº®ï¼ˆå‘¨æœŸæ€§ alpha/scaleï¼‰
rect.add_updater(lambda r: r.set_stroke(width=2 + 2*np.sin(2*np.pi*t.get_value())))
```

### 6.3 Updater ä¸æ—¶é—´è½´åŒæ­¥

```python
def add_dynamic_indicator(self, viz_group, t_start, t_end):
    """æ¯ä¸ªæ—¶é—´æ®µé‡ç½® tracker ç›®æ ‡å€¼ï¼Œä¸è®²è§£åŒæ­¥"""
    t = ValueTracker(0)
    
    # ç»‘å®š updater
    decimal.add_updater(lambda d: d.set_value(10 * t.get_value()))
    
    # ä¸æ—¶é—´è½´å¯¹é½
    self.play(
        t.animate.set_value(1),
        run_time=t_end - t_start,
        rate_func=linear
    )
```

### 6.4 é™æ€å†…å®¹å¿…é¡»è¡¥è½»é‡åŠ¨æ€

å³ä½¿æœ¬æ®µå†…å®¹æœ¬è´¨é™æ€ï¼Œä¹Ÿå¿…é¡»åŠ å…¥"è½»é‡åŠ¨æ€"ï¼š
- å…³é”®æ¡†å‘¼å¸é«˜äº®ï¼ˆå‘¨æœŸæ€§ stroke_width/opacityï¼‰
- æ—¶é—´è½´æ¸¸æ ‡ç§»åŠ¨
- æ‰«æçº¿ä»å·¦åˆ°å³
- ç›¸æœºå¾®å¹³ç§»ï¼ˆå»ºè®®ç”¨ updater è€Œé animateï¼‰

---

## 7. å­—å¹•ä¸é…éŸ³ç³»ç»Ÿ

### 7.1 AutoScene å­—å¹•ç®¡çº¿

```python
# æ–¹å¼ 1ï¼šspeak() è‡ªåŠ¨é…éŸ³ + å­—å¹•
duration = self.speak("æ¬¢è¿è§‚çœ‹æœ¬è§†é¢‘")

# æ–¹å¼ 2ï¼šspeak_with_highlight() é…éŸ³ + é«˜äº®
self.speak_with_highlight(
    text="çœ‹è¿™ä¸ªå…¬å¼",
    subtitle="çœ‹è¿™ä¸ªå…¬å¼",
    targets=[formula],
    color_map={"å…¬å¼": YELLOW}
)

# æ–¹å¼ 3ï¼šspeak_sequence() æ‰¹é‡é…éŸ³
self.speak_sequence([
    "ç¬¬ä¸€å¥è¯",
    "ç¬¬äºŒå¥è¯",
    {"text": "ç¬¬ä¸‰å¥", "color_map": {"ç¬¬ä¸‰å¥": RED}},
])

# æ–¹å¼ 4ï¼šrun_timeline() å®Œæ•´æ—¶é—´è½´
self.run_timeline(events, generate_voice=True)
```

### 7.2 å­—å¹•æ ·å¼é…ç½®

```python
self.set_subtitle_style(
    font_size=22,
    edge_buff=0.3,
    max_chars=18  # ç«–ç‰ˆæ¯è¡Œå­—ç¬¦æ•°
)
```

### 7.3 å­—å¹•åŠ¨ç”»è§„åˆ™

```
ç¬¬ 1 å¥ï¼šWrite(subtitle)
ç¬¬ 2+ å¥ï¼šTransform(old_subtitle, new_subtitle)
æœ€åæ¸…é™¤ï¼šFadeOut(subtitle)
```

### 7.4 å­—å¹•ä¸ä¸Šå±å…¬å¼é…åˆ

```python
# å…ˆå­—å¹•åå…¬å¼ï¼ˆæ¨èï¼‰
self.speak("æ¥ä¸‹æ¥çœ‹å…¬å¼")
self.play(Write(formula))

# æˆ–å¹¶è¡Œå‡ºç°
self.speak_with_highlight("çœ‹è¿™ä¸ªå…¬å¼", targets=[formula])
```

---

## 8. ç›¸æœºä¸æ„å›¾æ§åˆ¶

### 8.1 ç›¸æœºä½¿ç”¨åŸåˆ™

- âœ… åªåœ¨"å¼ºè°ƒå±€éƒ¨"æ—¶ä½¿ç”¨ç›¸æœºç§»åŠ¨
- âœ… å®Œæ•´èŠ‚å¥ï¼šå¼€å§‹ â†’ åœç•™ â†’ æ¢å¤
- âŒ é¿å…é¢‘ç¹æŠ–åŠ¨
- âŒ é¿å…æ— ç›®çš„æ¼‚ç§»

### 8.2 camera_focus ä½¿ç”¨

```python
# èšç„¦åæ¢å¤
self.camera_focus(
    target=dot,
    zoom_factor=3.0,
    focus_time=0.8,
    hold_time=1.5,
    restore_time=0.8
)
```

### 8.3 focus_guide_with_camera ä½¿ç”¨

```python
# æ–¹æ¡†å¼•å¯¼ + ç›¸æœºè·Ÿéš
self.focus_guide_with_camera(
    targets=[formula["a^2"], formula["b^2"], formula["c^2"]],
    zoom_factor=2.5,
    hold_time=1.5,
    restore_after=True
)
```

### 8.4 å›ºå®šå…ƒç´  fix_in_frame

```python
# å¿…é¡»å›ºå®šçš„å…ƒç´ ï¼ˆç›¸æœºç§»åŠ¨æ—¶ä¸å˜ï¼‰
title.fix_in_frame()
subtitle.fix_in_frame()
divider.fix_in_frame()

# ä¸å›ºå®šçš„å…ƒç´ ï¼ˆè·Ÿéšç›¸æœºï¼‰
# å¯è§†åŒ–åŒºåŸŸã€éƒ¨åˆ†æ¨å¯¼å†…å®¹
```

---

## 9. éŸ³æ•ˆä¸é…ä¹ç­–ç•¥

### 9.1 SoundLibrary ä½¿ç”¨

```python
# å¯ç”¨åŠ¨ç”»éŸ³æ•ˆ
self.set_animation_sounds_enabled(True)
self.set_add_sounds_enabled(False)  # add() éŸ³æ•ˆé€šå¸¸å…³é—­
self.set_sound_gain(0.6)  # éŸ³é‡ 60%
```

### 9.2 éŸ³æ•ˆè§¦å‘åŸåˆ™

| åŠ¨ç”»ç±»å‹ | éŸ³æ•ˆæ–‡ä»¶å¤¹ | ä½¿ç”¨åœºæ™¯ |
|----------|------------|----------|
| Write/ShowCreation | creation/ | é¦–æ¬¡å†™å…¥ |
| FadeIn/FadeOut | fade/ | å‡ºç°/æ¶ˆå¤± |
| Transform | transform/ | å½¢æ€å˜åŒ– |
| Indicate/Flash | indicate/ | å¼ºè°ƒé«˜äº® |
| GrowArrow | grow/ | ç®­å¤´ç”Ÿé•¿ |

### 9.3 éŸ³æ•ˆä½¿ç”¨è§„èŒƒ

- âœ… åªåœ¨å…³é”®åŠ¨ä½œè§¦å‘ï¼Œä¸è¦å…¨ç¨‹é“ºæ»¡
- âœ… éŸ³æ•ˆå¢ç›Šç»Ÿä¸€æ§åˆ¶ï¼ˆ0.4â€“0.6ï¼‰
- âœ… é…éŸ³ä¼˜å…ˆï¼ŒéŸ³æ•ˆè¾…åŠ©
- âŒ é¿å…éŸ³æ•ˆä¸é…éŸ³å†²çª
- âŒ é¿å…è¿ç»­é‡å¤éŸ³æ•ˆ

### 9.4 èƒŒæ™¯éŸ³ä¹ï¼ˆå¦‚æœ‰ï¼‰

- BGM éŸ³é‡éœ€ä½é¢‘å¼±åŒ–
- é…éŸ³æ®µ BGM è‡ªåŠ¨é™ä½
- é‡ç‚¹æ®µè½å¯æš‚åœ BGM

---

## 10. è§†è§‰å¼•å¯¼ä¸æ ‡æ³¨ç³»ç»Ÿ

### 10.1 focus_guide æ–¹æ¡†å¼•å¯¼

```python
# ä¾æ¬¡é«˜äº®å¤šä¸ªç›®æ ‡
self.focus_guide(
    targets=[formula["a"], formula["b"], formula["c"]],
    hold_time=1.0,
    box_buff=0.1,
    stroke_width=3
)

# æˆ–æŒ‰å…³é”®è¯å¼•å¯¼
self.focus_guide_sequence(
    text_mobject=sentence,
    keywords=["å‘é‡", "åŠ æ³•", "äº¤æ¢å¾‹"],
    hold_time=1.0
)
```

### 10.2 å¼¯æ›²ç®­å¤´æ ‡æ³¨

```python
# å•ä¸ªæ ‡æ³¨
ann = self.add_curved_annotation(
    target=formula["c^2"],
    annotation="æ–œè¾¹çš„å¹³æ–¹",
    direction="ur"  # å³ä¸Šæ–¹å‘
)

# æ‰¹é‡æ ‡æ³¨
annotations = self.add_multi_curved_annotations([
    {"target": formula["a^2"], "text": "ç›´è§’è¾¹a", "direction": "ul"},
    {"target": formula["b^2"], "text": "ç›´è§’è¾¹b", "direction": "up"},
    {"target": formula["c^2"], "text": "æ–œè¾¹", "direction": "ur"},
])
```

### 10.3 åŒºåŸŸæ ‡æ³¨ annotate_region

```python
# çº¯è‰²èƒŒæ™¯è¦†ç›– + æ ‡æ³¨
ann = self.annotate_region(
    region=circle,
    annotation="è¿™æ˜¯ä¸€ä¸ªåœ†",
    bg_color=BLUE
)
```

### 10.4 highlight_text é«˜äº®æ•ˆæœ

```python
# å¯é€‰æ•ˆæœï¼šbox/underline/background/indicate/focus/wave/random
decoration = self.highlight_text(formula, effect="box")

# ç§»é™¤é«˜äº®
self.remove_highlight(decoration)
```

### 10.5 å›ºå®šæ ‡æ³¨ï¼ˆ3D åœºæ™¯ï¼‰

```python
# å§‹ç»ˆé¢å‘ç›¸æœºçš„æ ‡æ³¨
label = self.add_fixed_annotation(sphere, "çƒä½“", direction=DOWN)

# åŠ¨æ€è·Ÿéšçš„æ ‡æ³¨
dynamic_label = self.add_fixed_annotation_dynamic(moving_obj, "è·Ÿéš")
```

---

## 11. è¾‰å…‰ä¸ç‰¹æ•ˆä½¿ç”¨

### 11.1 è¾‰å…‰æ–‡å­—/å…¬å¼

```python
# è¾‰å…‰æ–‡å­—
glow_text = self.create_glow_text("æ ‡é¢˜", color=YELLOW)

# è¾‰å…‰å…¬å¼
glow_tex = self.create_glow_tex(r"E=mc^2", color=BLUE)
```

### 11.2 æ›²çº¿è¾‰å…‰

```python
# ç»™æ›²çº¿æ·»åŠ è¾‰å…‰
glow = self.add_glow_to_curve(circle, glow_factor=2.0)

# è„‰åŠ¨è¾‰å…‰æ›²çº¿
pulse_curve = self.create_pulse_glow_curve(
    start=LEFT, end=RIGHT, color=YELLOW
)
```

### 11.3 è¾‰å…‰ä½¿ç”¨åŸåˆ™

- âœ… ç”¨äºæ ‡é¢˜ã€å…³é”®ç»“è®ºã€é‡ç‚¹å…¬å¼
- âœ… è¾‰å…‰é¢œè‰²ä¸æ–‡å­—é¢œè‰²åè°ƒ
- âŒ é¿å…å…¨å±è¾‰å…‰
- âŒ é¿å…è¾‰å…‰å åŠ ï¼ˆæ€§èƒ½é—®é¢˜ï¼‰

---

## 12. é¢œè‰²ä¸é…è‰²ç­–ç•¥

### 12.1 é»˜è®¤é…è‰²æ–¹æ¡ˆ

```python
# åŸºç¡€è‰²
TEXT_COLOR = WHITE       # é»˜è®¤æ–‡å­—
ACCENT_COLOR = YELLOW    # å¼ºè°ƒè‰²ï¼ˆå”¯ä¸€ï¼‰
HIGHLIGHT_COLOR = RED    # é«˜äº®è‰²ï¼ˆçŸ­æš‚ä½¿ç”¨ï¼‰

# å¯è§†åŒ–è‰²
FUNC_COLOR_NEG = BLUE    # x < 0 éƒ¨åˆ†
FUNC_COLOR_POS = RED     # x > 0 éƒ¨åˆ†
AXIS_COLOR = WHITE       # åæ ‡è½´
```

### 12.2 å¼ºè°ƒè‰²ä½¿ç”¨è§„åˆ™

```python
# å¼ºè°ƒçº¦ 2s åæ¢å¤
self.play(formula.animate.set_color(RED), run_time=0.5)
self.wait(2)
self.play(formula.animate.set_color(WHITE), run_time=0.5)
```

### 12.3 ç¦æ­¢çš„é…è‰²è¡Œä¸º

- âŒ åŒå±è¶…è¿‡ 4 ç§é¢œè‰²
- âŒ è¿ç»­é—ªçƒå˜è‰²
- âŒ å¤§é¢ç§¯å½©è‰²èƒŒæ™¯
- âŒ çº¢ç»¿æ­é…ï¼ˆè‰²ç›²ä¸å‹å¥½ï¼‰

### 12.4 Text ä¸Šè‰²æ–¹å¼

```python
# ä½¿ç”¨ t2c / text2color
text = Text(
    "é‡ç‚¹æ˜¯å‘é‡",
    font="STKaiti",
    t2c={"é‡ç‚¹": RED, "å‘é‡": YELLOW}
)

# æˆ–ä½¿ç”¨ color_mapï¼ˆå­—å¹•ï¼‰
self.speak("é‡ç‚¹æ˜¯å‘é‡", color_map={"é‡ç‚¹": RED})
```

---

## 13. ä»£ç ç»„ç»‡ä¸å¯ç»´æŠ¤æ€§

### 13.1 ç±»ç»“æ„æ¨¡æ¿

```python
class MyScene(AutoScene):
    # ========== å¸¸é‡é…ç½®åŒº ==========
    # æ¯ä¸ªç‰©ä½“éƒ½è¦æœ‰å¯è°ƒè¯•çš„ä½ç½®/å¤§å°å…¥å£
    TITLE_Y = 5.5          # æ ‡é¢˜ Y åæ ‡
    PROBLEM_Y = 3.5        # é¢˜ç›® Y åæ ‡
    VIZ_Y = 0.8            # å¯è§†åŒ– Y åæ ‡
    SOLUTION_Y = -2.2      # è§£ç­” Y åæ ‡
    
    SCREEN_WIDTH = 27/4    # ç«–ç‰ˆå®‰å…¨å®½åº¦
    
    TITLE_FONT_SIZE = 24
    PROBLEM_FONT_SIZE = 24
    SOLUTION_FONT_SIZE = 24
    
    # ========== é¢œè‰²é…ç½® ==========
    HIGHLIGHT_COLOR = YELLOW
    ACCENT_COLOR = RED
    
    def construct(self):
        """ä¸»æµç¨‹è°ƒåº¦ï¼ˆåªåšæµç¨‹æ§åˆ¶ï¼‰"""
        self.setup_scene()
        self.phase1_title()
        self.phase2_problem()
        self.phase3_viz()
        self.phase4_derivation()
        self.phase5_ending()
    
    def setup_scene(self):
        """åœºæ™¯åˆå§‹åŒ–"""
        self.enable_debug(True)
        self.set_animation_sounds_enabled(True)
        self.set_subtitle_style(font_size=22, edge_buff=0.3)
        self.shared_objects = {}  # è·¨é˜¶æ®µå…±äº«å¯¹è±¡
    
    def phase1_title(self):
        """é˜¶æ®µ 1ï¼šæ ‡é¢˜å±•ç¤º"""
        # å‰åŠéƒ¨åˆ†ï¼šåˆ›å»ºå¯¹è±¡å¹¶æ‘†æ”¾
        title = Text("æ ‡é¢˜", font="STKaiti", font_size=self.TITLE_FONT_SIZE)
        title.move_to(UP * self.TITLE_Y)
        
        # ååŠéƒ¨åˆ†ï¼šç»Ÿä¸€åŠ¨ç”»
        self.play(Write(title), rate_func=smooth, run_time=1)
        self.speak("æ¬¢è¿è§‚çœ‹")
        
        # ä¿å­˜è·¨é˜¶æ®µå¯¹è±¡
        self.shared_objects["title"] = title
```

### 13.2 é˜¶æ®µç‹¬ç«‹å¯è°ƒè¯•

```python
def construct(self):
    self.setup_scene()
    # æ³¨é‡Šå…¶ä»–é˜¶æ®µå¯å•ç‹¬è°ƒè¯•
    self.phase1_title()
    # self.phase2_problem()
    # self.phase3_viz()
```

### 13.3 å¯¹è±¡æ¸…ç†è§„åˆ™

```python
def phase2_problem(self):
    # é˜¶æ®µå¼€å§‹ï¼šæ£€æŸ¥å‰ç½®æ¡ä»¶
    if "title" not in self.shared_objects:
        raise ValueError("éœ€è¦å…ˆæ‰§è¡Œ phase1_title")
    
    # ... é˜¶æ®µé€»è¾‘ ...
    
    # é˜¶æ®µç»“æŸï¼šæ¸…ç†ä¸´æ—¶å¯¹è±¡ï¼Œä¿ç•™å…±äº«å¯¹è±¡
    self.remove(temp_annotation)
    self.shared_objects["problem"] = problem_group
```

### 13.4 é®æŒ¡å…³ç³»æ§åˆ¶

```python
# å add çš„å¯¹è±¡åœ¨ä¸Šå±‚
self.add(background)      # æœ€åº•å±‚
self.add(axes)            # ä¸­é—´å±‚
self.add(curve)           # ä¸Šå±‚
self.add(annotation)      # æœ€ä¸Šå±‚
```

---

## 14. æ€§èƒ½ä¸æ¸²æŸ“ç¨³å®šæ€§

### 14.1 always_redraw æ€§èƒ½æ§åˆ¶

```python
# âœ… å¿…è¦æ—¶ä½¿ç”¨ always_redraw
curve = always_redraw(get_dynamic_curve)

# âš ï¸ æ•°é‡å—æ§ï¼ˆå»ºè®® â‰¤ 5 ä¸ªï¼‰
# âš ï¸ åŠ¨ç”»ç»“æŸåè½¬ä¸ºé™æ€
if animation_done:
    static_curve = get_dynamic_curve()
    self.remove(curve)
    self.add(static_curve)
```

### 14.2 å¤æ‚åº¦æ§åˆ¶

| å…ƒç´  | å»ºè®®é™åˆ¶ |
|------|----------|
| always_redraw å¯¹è±¡ | â‰¤ 5 ä¸ª |
| åŒå±ç‚¹æ•° | â‰¤ 1000 |
| è¾‰å…‰å±‚æ•° | â‰¤ 3 å±‚ |
| æè¾¹å¤æ‚åº¦ | stroke_width â‰¤ 6 |

### 14.3 æ¸²æŸ“å‰é¢„è§ˆæµç¨‹

```bash
# 1. å°åˆ†è¾¨ç‡é¢„è§ˆï¼ˆç¡®è®¤æ—¶åºï¼‰
manimgl script.py SceneName --resolution 480x854

# 2. ç¡®è®¤æ— è¯¯åé«˜åˆ†è¾¨ç‡æ¸²æŸ“
manimgl script.py SceneName -w --resolution 1080x1920
```

### 14.4 è‡ªæ£€è¾“å‡º

```python
def construct(self):
    # æ¸²æŸ“å‰è‡ªæ£€
    print("="*50)
    print(f"è§†é¢‘æ ‡é¢˜: {self.meta['title']}")
    print(f"ç›®æ ‡æ—¶é•¿: {self.timeline[-1]['end']}s")
    print("="*50)
    
    for e in self.timeline:
        duration = e['end'] - e['start']
        if duration < 0:
            raise ValueError(f"è´Ÿæ—¶é•¿ï¼äº‹ä»¶: {e['scene_id']}")
        print(f"[{e['start']:.1f}-{e['end']:.1f}] {e['visual_action']}: {e['narration'][:20]}...")
```

---

## 15. è‡ªåŠ¨åŒ–å·¥å…·ä¸æ£€æŸ¥å™¨

### 15.1 JSON Schema æ ¡éªŒå™¨

```python
def validate_timeline_json(data: dict) -> list[str]:
    """
    æ ¡éªŒæ—¶é—´è½´ JSON
    
    æ£€æŸ¥é¡¹ï¼š
    - meta å­—æ®µå®Œæ•´æ€§
    - start/end å•è°ƒé€’å¢
    - æ— è´Ÿæ—¶é•¿
    - visual_action è¦†ç›–ç‡ 100%
    - å¥é•¿ â‰¤ 26 å­—
    """
    errors = []
    
    # ... æ ¡éªŒé€»è¾‘ ...
    
    return errors
```

### 15.2 å¸ƒå±€æ£€æŸ¥å™¨

```python
def check_layout(scene) -> list[str]:
    """
    æ£€æŸ¥å¸ƒå±€é—®é¢˜
    
    æ£€æŸ¥é¡¹ï¼š
    - å…ƒç´ æ˜¯å¦è¶Šç•Œ
    - å…ƒç´ æ˜¯å¦é‡å 
    - è¡Œå®½æ˜¯å¦è¿‡çª„ï¼ˆ< 85%ï¼‰
    - æ¨å¯¼åŒºæ˜¯å¦å‹ä½å­—å¹•
    """
```

### 15.3 åŠ¨æ€æ£€æŸ¥å™¨

```python
def check_dynamics(scene) -> list[str]:
    """
    æ£€æŸ¥åŠ¨æ€å…ƒç´ 
    
    æ£€æŸ¥é¡¹ï¼š
    - æ˜¯å¦å­˜åœ¨ Updater
    - æ˜¯å¦å­˜åœ¨ always_redraw
    - æ˜¯å¦å­˜åœ¨ ValueTracker
    """
```

### 15.4 æ—¶é—´è½´å¯è§†åŒ–é¢„è§ˆ

```python
def visualize_timeline(events: list) -> None:
    """
    ç”Ÿæˆæ—¶é—´è½´æ¡å½¢å›¾
    
    æ˜¾ç¤ºï¼š
    - æ¯å¥ narration
    - å¯¹åº” visual_action
    - æ—¶é—´æ®µé•¿åº¦
    """
```

---

## 16. äº¤ä»˜å‰æ£€æŸ¥æ¸…å•

### 16.1 å¿…æ£€é¡¹ âœ…

- [ ] æ—¶é—´è½´æ— é‡å ã€æ— è´Ÿæ—¶é•¿
- [ ] ä»£ç å¯ä¸€æ¬¡è¿è¡ŒæˆåŠŸ
- [ ] æ—  LaTeX ç¼–è¯‘é”™è¯¯
- [ ] å­—å¹•ä¸é…éŸ³åŒæ­¥ï¼ˆè¯¯å·® â‰¤ 0.2sï¼‰
- [ ] ç”»é¢æ— è¶…å®½/è¶Šç•Œ
- [ ] æ¨å¯¼åŒºä¸å‹ä½å­—å¹•

### 16.2 æ¨èé¡¹ â­

- [ ] å¯è§†åŒ–åŒºå­˜åœ¨æŒç»­åŠ¨æ€ï¼ˆUpdaterï¼‰
- [ ] å…³é”®ç»“è®ºæœ‰é«˜äº®/æ¡†é€‰/ç›¸æœºèšç„¦
- [ ] é¢œè‰²ä½“ç³»ä¸€è‡´ï¼ˆWHITE + å•ä¸€å¼ºè°ƒè‰²ï¼‰
- [ ] Transform è¡”æ¥ â‰¥ 50%
- [ ] å¼€åœº 3 ç§’ï¼šé…éŸ³ + åŠ¨ç”» + éŸ³æ•ˆåŒæ—¶å‡ºç°
- [ ] é…éŸ³è‡ªç„¶æµç•…ï¼ˆæ— å¡é¡¿/æ— æ‚éŸ³ï¼‰

### 16.3 åŠ åˆ†é¡¹ ğŸŒŸ

- [ ] å¯è§†åŒ–æ ‡ç­¾ä½¿ç”¨å½©è‰²èƒŒæ™¯çªå‡º
- [ ] è¾‰å…‰æ•ˆæœç”¨äºå…³é”®å…ƒç´ 
- [ ] ç›¸æœºèšç„¦ç”¨äºå¼ºè°ƒå±€éƒ¨
- [ ] éŸ³æ•ˆä¸åŠ¨ç”»ç±»å‹åŒ¹é…
- [ ] ä»£ç æ³¨é‡Šæ¸…æ™°å®Œæ•´

---

## 17. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 17.1 LaTeX ç¼–è¯‘é”™è¯¯

```python
# é—®é¢˜ï¼š\div åœ¨ ManimGL ä¸­ä¸æ”¯æŒ
# è§£å†³ï¼šä½¿ç”¨ Ã· æ›¿ä»£
div = Tex(r"6 \div 2 = 3")  # âŒ
div = Tex("6Ã·2=3")          # âœ…
```

### 17.2 ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜

```python
# é—®é¢˜ï¼šä¸­æ–‡ä¹±ç æˆ–ä¸æ˜¾ç¤º
# è§£å†³ï¼šæŒ‡å®šå­—ä½“
text = Text("ä¸­æ–‡å†…å®¹", font="STKaiti")  # âœ…
```

### 17.3 å¸ƒå±€è¶Šç•Œ

```python
# é—®é¢˜ï¼šæ–‡æœ¬è¶…å‡ºå±å¹•
# è§£å†³ï¼šä½¿ç”¨ auto_wrap æˆ– scale_to_fit_width
if mobject.get_width() > SCREEN_WIDTH:
    mobject.scale_to_fit_width(SCREEN_WIDTH * 0.95)
```

### 17.4 æ—¶é—´è½´ä¸åŒæ­¥

```python
# é—®é¢˜ï¼šéŸ³ç”»ä¸åŒæ­¥
# è§£å†³ï¼šä½¿ç”¨æ—¶é—´è½´é©±åŠ¨å™¨ä¸‰ä»¶å¥—
def play_t(self, *anims, rt=1):
    self.play(*anims, run_time=rt, rate_func=smooth)
    self.t += rt

def wait_t(self, dt):
    self.wait(dt)
    self.t += dt

def wait_until(self, target):
    if target > self.t:
        self.wait_t(target - self.t)
```

### 17.5 always_redraw æ€§èƒ½é—®é¢˜

```python
# é—®é¢˜ï¼šå¸§ç‡ä¸‹é™
# è§£å†³ï¼šåŠ¨ç”»ç»“æŸåè½¬ä¸ºé™æ€
# æˆ–å‡å°‘ always_redraw æ•°é‡
```

### 17.6 éŸ³æ•ˆä¸æ’­æ”¾

```python
# é—®é¢˜ï¼šSoundLibrary æœªæ‰¾åˆ°
# è§£å†³ï¼šæ£€æŸ¥è·¯å¾„é…ç½®
self._sound_library = SoundLibrary(
    library_path="E:/auto_manim/assets/sounds/library"
)
```

---

## 18. åç»­å¯è½åœ°ä¼˜åŒ–é¡¹

### 18.1 çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2 å‘¨ï¼‰

- [ ] **auto_wrap Tex å®‰å…¨æ–­è¡Œ**
  - ä¸æ‹†å `\command{...}` ç»“æ„
  - ä¸æ‹†åå¤§æ‹¬å·é…å¯¹
  - æ”¯æŒæ··åˆä¸­è‹±æ–‡

- [ ] **ç»Ÿä¸€é£æ ¼é…ç½®æ–‡ä»¶**
  ```yaml
  # style_config.yaml
  fonts:
    chinese: STKaiti
    english: Arial
  sizes:
    title: 48
    body: 36
    subtitle: 28
  colors:
    text: "#FFFFFF"
    accent: "#FFFF00"
    highlight: "#FF0000"
  ```

### 18.2 ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2 æœˆï¼‰

- [ ] **æ¨¡æ¿åœºæ™¯åº“æ²‰æ·€**
  - å‡½æ•°å›¾åƒé¢˜æ¨¡æ¿
  - å‡ ä½•è¯æ˜é¢˜æ¨¡æ¿
  - æ¦‚ç‡ç»Ÿè®¡é¢˜æ¨¡æ¿
  - ä¸ç­‰å¼æ¨å¯¼æ¨¡æ¿

- [ ] **JSON Schema æ ¡éªŒå·¥å…·**
  - å‘½ä»¤è¡Œå·¥å…·
  - è‡ªåŠ¨ä¿®å¤å»ºè®®

### 18.3 é•¿æœŸä¼˜åŒ–ï¼ˆ3-6 æœˆï¼‰

- [ ] **æ—¶é—´è½´å¯è§†åŒ–ç¼–è¾‘å™¨**
  - æ‹–æ‹½è°ƒæ•´æ—¶é—´
  - é¢„è§ˆå­—å¹•
  - å¯¼å‡º JSON

- [ ] **è‡ªåŠ¨å¸ƒå±€å¼•æ“**
  - æ™ºèƒ½é¿è®©
  - è‡ªåŠ¨ç¼©æ”¾
  - è‡ªåŠ¨å¯¹é½

- [ ] **AI ä»£ç è´¨é‡æ£€æŸ¥**
  - è‡ªåŠ¨æ£€æµ‹å¸¸è§é”™è¯¯
  - ä¼˜åŒ–å»ºè®®
  - é£æ ¼ä¸€è‡´æ€§æ£€æŸ¥

---

## ğŸ“ é™„å½•

### A. æ¸²æŸ“å‘½ä»¤é€ŸæŸ¥

```bash
# é¢„è§ˆæ¨¡å¼
manimgl script.py SceneName

# è¾“å‡ºè§†é¢‘
manimgl script.py SceneName -w

# ç«–ç‰ˆè§†é¢‘ (9:16)
manimgl script.py SceneName -w --resolution 1080x1920

# æ¨ªç‰ˆè§†é¢‘ (16:9)
manimgl script.py SceneName -w --resolution 1920x1080

# ä½åˆ†è¾¨ç‡é¢„è§ˆ
manimgl script.py SceneName --resolution 480x854
```

### B. AutoScene API é€ŸæŸ¥

| æ–¹æ³• | ç”¨é€” |
|------|------|
| `speak(text)` | é…éŸ³ + å­—å¹• |
| `speak_with_highlight(text, targets)` | é…éŸ³ + é«˜äº® |
| `focus_guide(targets)` | æ–¹æ¡†å¼•å¯¼ |
| `focus_guide_with_camera(targets)` | æ–¹æ¡† + ç›¸æœº |
| `camera_focus(target)` | ç›¸æœºèšç„¦ |
| `add_curved_annotation(target, text)` | å¼¯æ›²ç®­å¤´æ ‡æ³¨ |
| `highlight_text(target, effect)` | é«˜äº®æ•ˆæœ |
| `ensure_above_subtitle(mobject)` | é˜²å­—å¹•é‡å  |

### C. é¢œè‰²å¸¸é‡é€ŸæŸ¥

```python
from manimlib import (
    WHITE, BLACK, GREY,
    RED, BLUE, GREEN, YELLOW,
    ORANGE, PINK, PURPLE, TEAL, GOLD,
    UP, DOWN, LEFT, RIGHT, ORIGIN,
    UL, UR, DL, DR
)
```

---

*æ–‡æ¡£ç‰ˆæœ¬ï¼šv2.0*
*æ›´æ–°æ—¥æœŸï¼š2025-12-22*
*ç»´æŠ¤è€…ï¼šauto_manim é¡¹ç›®ç»„*
